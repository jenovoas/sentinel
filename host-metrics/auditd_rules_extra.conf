# Sentinel auditd reglas extra (laboratorio)
# Cambios en /etc y binarios críticos, exec en /tmp, módulos kernel

# Cambios de permisos/propietario en /etc
-a always,exit -F dir=/etc -F perm=wa -k etc-change

# Syscalls sensibles de archivos (chmod/chown/rename/unlink) en /etc
-a always,exit -F arch=b64 -S chmod,chown,fchmod,fchown,rename,unlink -F dir=/etc -k etc-syscalls

# Accesos a shadow/passwd fallidos
-a always,exit -F arch=b64 -S open,openat -F path=/etc/shadow -F success=0 -k shadow-access
-a always,exit -F arch=b64 -S open,openat -F path=/etc/passwd -F success=0 -k passwd-access

# Execs desde /tmp y /var/tmp
-a always,exit -F arch=b64 -S execve -F dir=/tmp -k tmp-exec
-a always,exit -F arch=b64 -S execve -F dir=/var/tmp -k tmp-exec

# Módulos de kernel
-a always,exit -F arch=b64 -S init_module,delete_module -k kmod-change
